<% if logged_in? %>
  <div class="row">
    <aside class="col-md-4">
      <section class="user_info">
        <%= render 'shared/user_info' %>
      </section>
<<<<<<< HEAD
      <section>
        <%= render 'shared/stats' %>
      </section>
      
=======
      <section class="stats">
        <%= render 'shared/stats' %>
      </section>
>>>>>>> 566092c7e3f4c5c7786e43ea01c7934333535730
      <section class="crap_form">
        <%= render 'shared/crap_form' %>
      </section>
      <p><button onclick="geoFindMe()">Show me the closest crapper</button></p>
<div id="out"></div>
    </aside>
    <div class="col-md-8">
      <h3>Best Dumps</h3>
      <%= render 'shared/feed' %>
    </div>
  </div>
<% else %>
<div class="row">
  <aside class="col-md-4">
    <h1>Crap Chat</h1>
    <p>Welcome to Crap Chat</p>
    <p><button onclick="geoFindMe()">Show me the closest crapper</button></p>
<div id="out"></div>
  </aside>
  <div class="col-md-8">
      <h3>Best Dumps</h3>
      <%= render 'shared/homecrap' %>
  </div>
</div>

<% end %>



<script>

	function geoFindMe() {
		var output = document.getElementById("out");

  		if (!navigator.geolocation){
    		output.innerHTML = "<p>Geolocation is not supported by your browser</p>";
    		return;
  		}

	function success(position) {
    	var latitude  = position.coords.latitude;
    	var longitude = position.coords.longitude;

    	output.innerHTML = '<p>Latitude is ' + latitude + '° <br>Longitude is ' + longitude + '°</p>';

    	var img = new Image();
    	img.src = "https://maps.googleapis.com/maps/api/staticmap?center=" + latitude + "," + longitude + "&zoom=13&size=300x300&sensor=false";

    	output.appendChild(img);
  	};

	function error() {
    output.innerHTML = "Unable to retrieve your location";
  	};

	output.innerHTML = "<p>Locating…</p>";

	navigator.geolocation.getCurrentPosition(success, error);

	}

</script>

